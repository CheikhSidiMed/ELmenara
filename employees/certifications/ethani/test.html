<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تصميم </title>
    <link rel="stylesheet" href="../css/topbar.css">
    <style>
        :root {
            --primary-color: #1BA078;
            --overlay-size: 150px;
        }
        
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        
        .header-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            height: 300px; /* Match your main photo height */
        }
        
        .main-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .header-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2; /* Above the main photo */
        }
        
        .cls-75 {
            fill: rgba(27, 160, 120, 0.5); /* Semi-transparent green */
        }
        
        .overlay-photo-container {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 3; /* Above both SVG and main photo */
        }
        
        .overlay-photo {
            width: var(--overlay-size);
            height: var(--overlay-size);
            border-radius: 50%;
            border: 3px solid white;
            object-fit: cover;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .upload-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 4; /* Above everything */
        }
        
        .upload-btn {
            background-color: rgba(0,0,0,0.7);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .upload-btn:hover {
            background-color: var(--primary-color);
        }
        
        .content {
            padding: 20px;
            margin-top: 20px;
        }
        
        input[type="file"] {
            display: none;
        }
    </style>
    <style>
        .cls-1 {
          fill: #1b8878;
        }
  
        .cls-2 {
          clip-path: url(#clippath-6);
        }
  
        .cls-3 {
          clip-path: url(#clippath-7);
        }
  
        .cls-4 {
          fill: #666766;
        }
  
        .cls-4, .cls-5, .cls-6, .cls-7, .cls-8, .cls-9, .cls-10 {
          font-family: ExpoArabic-Book, 'Expo Arabic';
        }
  
        .cls-4, .cls-6 {
          font-size: 17px;
        }
  
        .cls-11 {
          fill: #9d7c63;
        }
  
        .cls-12 {
          fill: #119381;
        }
  
        .cls-13 {
          fill: #077364;
        }
  
        .cls-14 {
          fill: #087a6f;
        }
  
        .cls-15 {
          clip-path: url(#clippath-4);
        }
  
        .cls-16 {
          fill: #b68c37;
        }
  
        .cls-17 {
          fill: #047c6c;
        }
  
        .cls-18, .cls-19, .cls-20, .cls-21, .cls-22, .cls-23, .cls-24 {
          fill: none;
        }
  
        .cls-18, .cls-19, .cls-20, .cls-22, .cls-23, .cls-24 {
          stroke-miterlimit: 10;
        }
  
        .cls-18, .cls-23 {
          stroke: #bd9239;
        }
  
        .cls-25 {
          opacity: .29;
        }
  
        .cls-26 {
          font-size: 10.77px;
        }
  
        .cls-26, .cls-27 {
          font-family: ExpoArabic-Bold, 'Expo Arabic';
        }
  
        .cls-26, .cls-27, .cls-28 {
          font-weight: 700;
        }
  
        .cls-26, .cls-29 {
          fill: #058272;
        }
  
        .cls-27 {
          fill: #bf943a;
          font-size: 4.76px;
        }
  
        .cls-30 {
          fill: #c4963d;
        }
  
        .cls-19 {
          stroke: url(#linear-gradient);
        }
  
        .cls-31 {
          fill: #057f6e;
        }
  
        .cls-5 {
          font-size: 8.56px;
        }
  
        .cls-5, .cls-32, .cls-8 {
          fill: #007f6d;
        }
  
        .cls-33 {
          fill: #008c71;
        }
  
        .cls-34, .cls-35 {
          fill: #007b6a;
        }
  
        .cls-20 {
          stroke: #f7941d;
        }
  
        .cls-36 {
          fill: #118273;
        }
  
        .cls-37, .cls-38 {
          fill: #fff;
        }
  
        .cls-39 {
          fill: #067262;
        }
  
        .cls-40, .cls-38 {
          opacity: .17;
        }
  
        .cls-41 {
          fill: #178b7b;
        }
  
        .cls-42 {
          fill: #16907f;
        }
  
        .cls-6, .cls-10 {
          fill: #48494a;
        }
  
        .cls-43 {
          fill: #1a897a;
        }
  
        .cls-44 {
          fill: #119d85;
        }
  
        .cls-45 {
          fill: #168475;
        }
  
        .cls-46 {
          fill: #c7993d;
        }
  
        .cls-47 {
          fill: #0a7566;
        }
  
        .cls-48 {
          fill: url(#Degradado_sin_nombre_118-2);
        }
  
        .cls-48, .cls-49 {
          mix-blend-mode: screen;
          opacity: .51;
        }
  
        .cls-50 {
          fill: #bc9139;
        }
  
        .cls-51 {
          fill: #fafdfc;
        }
  
        .cls-52 {
          fill: #198777;
        }
  
        .cls-53 {
          fill: #158c7c;
        }
  
        .cls-22 {
          stroke: #b8b8b8;
          stroke-width: .56px;
        }
  
        .cls-54 {
          fill: url(#linear-gradient-3);
        }
  
        .cls-55 {
          clip-path: url(#clippath-1);
        }
  
        .cls-56 {
          fill: #037a69;
        }
  
        .cls-57 {
          fill: #189180;
        }
  
        .cls-58 {
          isolation: isolate;
        }
  
        .cls-23 {
          stroke-width: 6px;
        }
  
        .cls-59 {
          clip-path: url(#clippath-5);
        }
  
        .cls-60 {
          fill: #b89077;
        }
  
        .cls-61 {
          fill: #028170;
        }
  
        .cls-62 {
          fill: url(#linear-gradient-5);
        }
  
        .cls-62, .cls-63 {
          fill-rule: evenodd;
        }
  
        .cls-64 {
          clip-path: url(#clippath-8);
        }
  
        .cls-65 {
          fill: url(#linear-gradient-8);
        }
  
        .cls-66 {
          fill: #a98369;
        }
  
        .cls-67 {
          fill: #c49c7b;
        }
  
        .cls-68 {
          clip-path: url(#clippath-3);
        }
  
        .cls-69 {
          fill: #119783;
        }
  
        .cls-70 {
          fill: #c2953a;
        }
  
        .cls-71 {
          fill: #178e7c;
        }
  
        .cls-49 {
          fill: url(#Degradado_sin_nombre_118);
        }
  
        .cls-24 {
          stroke: url(#linear-gradient-2);
        }
  
        .cls-72 {
          fill: #0e9983;
        }
  
        .cls-73 {
          fill: #b78d38;
        }
  
        .cls-74 {
          fill: url(#linear-gradient-7);
        }
  
        .cls-75 {
          filter: url(#drop-shadow-3);
        }
  
        .cls-75, .cls-76 {
          fill: #bd9239;
        }
  
        .cls-77 {
          fill: #1b8677;
        }
  
        .cls-78 {
          fill: #f8ac3d;
        }
  
        .cls-63 {
          fill: url(#linear-gradient-4);
        }
  
        .cls-79 {
          fill: #9c7b62;
        }
  
        .cls-80 {
          fill: url(#linear-gradient-6);
        }
  
        .cls-7 {
          fill: #ad8337;
          font-size: 15.54px;
        }
  
        .cls-81 {
          fill: #027061;
        }
  
        .cls-82 {
          fill: #b38b39;
        }
  
        .cls-35 {
          font-family: SakkalMajalla, 'Sakkal Majalla';
          font-size: 7.47px;
        }
  
        .cls-8 {
          font-size: 9.13px;
        }
  
        .cls-83 {
          clip-path: url(#clippath-2);
        }
  
        .cls-84 {
          fill: #c99b3f;
        }
  
        .cls-85 {
          fill: #f6d5ab;
        }
  
        .cls-86 {
          fill: #0c9581;
        }
  
        .cls-87 {
          fill: #bd956f;
        }
  
        .cls-88 {
          fill: #ba8f39;
        }
  
        .cls-9 {
          fill: #0b7466;
          font-size: 3.98px;
        }
  
        .cls-89 {
          clip-path: url(#clippath);
        }
  
        .cls-90 {
          fill: #119a85;
        }
  
        .cls-91 {
          fill: #c0953a;
        }
  
        .cls-92 {
          fill: #047667;
        }
  
        .cls-28 {
          fill: #046757;
          font-family: Al-Jazeera-Arabic-Bold, Al-Jazeera-Arabic;
          font-size: 17.27px;
        }
  
        .cls-10 {
          font-size: 15px;
        }
      
        
        body {
          padding: 0;
          margin: 0;
      }
      #content {
          margin: 0 !important;
          padding: 0 !important;
      }

      input {
        width: 270px;
        padding: 8px;
        margin-bottom: 20px;
        border: 2px solid #1BA078;
        border-radius: 8px;
        font-size: 16px;
        color: #333;
        background-color: #f9f9f9;
        outline: none;
        transition: border-color 0.3s ease;
      }
      input::placeholder {
          color: #888;
      }

      input[type="file"] {
        cursor: pointer;
        font-size: 20px;
        padding: 5px;
      }

      button {
          padding: 12px;
          margin-bottom: 10px;
          border: none;
          border-radius: 8px;
          font-size: 16px;
          font-weight: bold;
          color: #fff;
          background-color: #1BA078;
          cursor: pointer;
          transition: background-color 0.3s ease;
      }

      button:hover {
          background-color: #165d8a;
      }

      button:active {
          transform: scale(0.98);
      }

      .b-group {
          text-align: center;
          justify-content: center;
          align-items: center;
      }
      </style>

</head>
<body>

    <div id="navbar-container"></div>

  <script>
      fetch("../navbar.html")
          .then(response => response.text())
          .then(data => {
              document.getElementById("navbar-container").innerHTML = data;
          })
          .catch(error => console.error("Erreur lors du chargement du menu :", error));
  </script>
<div class="certificate-container" style="width: 800px; height: 1000px; position: relative; background-color: #f8f5e9; margin: 0 auto; font-family: 'Traditional Arabic', Arial, sans-serif; padding: 40px; text-align: center; direction: rtl;">
    
  <!-- Decorative Border -->
  <div style="position: absolute; top: 0; left: 0; right: 0; height: 10px; background: #8b5a2b;"></div>
  <div style="position: absolute; bottom: 0; left: 0; right: 0; height: 10px; background: #8b5a2b;"></div>
  <div style="position: absolute; left: 0; top: 0; bottom: 0; width: 10px; background: #8b5a2b;"></div>
  <div style="position: absolute; right: 0; top: 0; bottom: 0; width: 10px; background: #8b5a2b;"></div>
  
  <!-- Logo/Header Placeholder -->
  <div style="margin-bottom: 30px;">
      <div style="font-size: 28px; color: #8b5a2b; font-weight: bold; margin-bottom: 10px;">محظرة المنارة والرباط</div>
      <div style="font-size: 18px; color: #555;">لتدريس العلوم الإسلامية</div>
  </div>
  
  <!-- Main Content -->
  <div style="margin: 40px 0; line-height: 2; font-size: 20px;">
      <p>تتقدم محظرة المنارة والرباط لتدريس العلوم الإسلامية</p>
      <p>(إدارة - وأساتذة - ووكلاء - وطلابا)</p>
      
      <div style="margin: 30px 0;">
          <p>بأحر التهاني وأطيب التبريكات</p>
          <p style="font-size: 24px; color: #8b5a2b; margin: 15px 0;">: للأستاذة المتميزة، الخلوقة، المُقرِئة</p>
          
          <!-- Name Placeholder -->
          <div style="font-size: 28px; font-weight: bold; color: #333; margin: 20px 0; padding: 10px; border-bottom: 2px dotted #8b5a2b; display: inline-block;">
              الأستاذة
          </div>
      </div>
      
      <p>وذلك بمناسبة</p>
      
      <!-- Poetry Section -->
      <div style="font-style: italic; margin: 40px 0; line-height: 2.5; font-size: 22px; color: #5a3921;">
          <p>وما نيل المطالب بالتمني</p>
          <p>ولكن تؤخذ الدنيا غلابا</p>
          <p>وما استعصى على قوم منال</p>
          <p>إذا الإقدام كان لهم ركابا</p>
      </div>
  </div>
  
  <!-- Footer -->
  <div style="margin-top: 50px; font-size: 18px;">
      <p>وفي الختام نهديها خالص التهاني</p>
      <p>ونتمنى لها مستقبلاً مشرقاً ونجاحاً مستمراً</p>
  </div>
  
  <!-- Signatures -->
  <div style="position: absolute; bottom: 50px; left: 0; right: 0; display: flex; justify-content: space-around; padding: 0 100px;">
      <div style="text-align: center;">
          <div style="border-top: 1px solid #8b5a2b; width: 150px; margin: 0 auto; padding-top: 5px;">التاريخ</div>
      </div>
      <div style="text-align: center;">
          <div style="border-top: 1px solid #8b5a2b; width: 150px; margin: 0 auto; padding-top: 5px;">مدير المحظرة</div>
      </div>
  </div>
  
  <!-- Decorative Element -->
  <div style="position: absolute; bottom: 30px; right: 50px; width: 80px; height: 80px; border: 2px dashed #8b5a2b; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #8b5a2b; font-size: 12px;">
      ختم المحظرة
  </div>
</div>
<div class="header-container">
    <svg class="header-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 595.28 821.89" preserveAspectRatio="none">
      <path class="cls-75" d="M452.85,0h95.09v103.87c0,9.6-7.79,17.4-17.4,17.4h-59.87c-9.84,0-17.82-7.99-17.82-17.82V0h0Z"/>

      <text class="cls-10" transform="translate(64.25 291.52) scale(.87 1)"><tspan x="60" y="0" xml:space="preserve"> تتقدم محظرة المنارة والرباط لتدريس العلوم الإسلامية  (إدارة - وأساتذة - ووكلاء - وطلابا)</tspan><tspan x="152.22" y="30.71" xml:space="preserve">:  بأحر النهاني وأطيب التبريكات  ؛ للأستاذة  المتميزة ، الخلوقة ، المُقرِئة </tspan></text>
      <text class="cls-6" transform="translate(72.21 636.6) scale(.87 1)"><tspan x="40" y="0">.وفي الختام نهديها خالص التهاني ونتمنى لها مستقبلا مشرقا ونجاحا مستمرا </tspan></text>
      <line class="cls-23" x1="0" y1="236.02" x2="595.28" y2="236.21"/>
    </svg>
    
    <!-- Main Background Photo -->
    <img id="mainPhoto" class="main-photo" src="https://via.placeholder.com/1920x300" alt="صورة الخلفية الرئيسية">
    
    <!-- Overlay Photo Container -->
    <div class="overlay-photo-container">
        <img id="overlayPhoto" class="overlay-photo" src="https://via.placeholder.com/150" alt="الصورة الشخصية">
        
        <div class="upload-controls">
            <label for="mainPhotoInput" class="upload-btn">
                تغيير الخلفية
            </label>
            <label for="overlayPhotoInput" class="upload-btn">
                تغيير الصورة
            </label>
        </div>
    </div>
    
    <!-- Hidden file inputs -->
    <input type="file" id="mainPhotoInput" accept="image/*">
    <input type="file" id="overlayPhotoInput" accept="image/*">


    <svg class="header-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 595.28 521.89" preserveAspectRatio="none">
        

    </svg>
</div>

<div class="content">
    <h1>محتوى الصفحة هنا</h1>
    <p>هذا هو المحتوى الأساسي لصفحتك أسفل الصور.</p>
</div>
    


<div id="content">

        <img id="photo" width="321"  />

</div>


<br>

<div class="b-group">
    <input type="text" id="nameIm" placeholder=" الأستاذة" dir="rtl">
    <input type="text" id="nameIv" placeholder=" وذلك بمناسبة" dir="rtl">
    <input type="date" id="nameDInput">
    <input type="file" id="photoInput1" accept="image/*">
    <!-- <input type="file" id="photoInput" accept="image/*"> -->

    <button onclick="updateSVG()">تحديــــــــث</button>
    <button id="saveButton">PNGحفظ كــــــــ</button>
    <button onclick="saveAsPDF()">PDFحفظ كـــــــــ</button>
</div>
<img id="photo" alt="Image preview">

<input type="file" id="photoInput" accept="image/*">


<script>
    // Handle main photo upload
    document.getElementById('mainPhotoInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file && file.type.match('image.*')) {
            const reader = new FileReader();
            reader.onload = function(event) {
                document.getElementById('mainPhoto').src = event.target.result;
            };
            reader.readAsDataURL(file);
        }
    });
    
    // Handle overlay photo upload
    document.getElementById('overlayPhotoInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file && file.type.match('image.*')) {
            const reader = new FileReader();
            reader.onload = function(event) {
                document.getElementById('overlayPhoto').src = event.target.result;
            };
            reader.readAsDataURL(file);
        }
    });
</script>




<!-- Include jsPDF Library -->
<script src="../../js/jspdf.umd.min.js"></script>
<script src="../../js/html2canvas.min.js"></script>
<script>
  document.getElementById('photoInput').addEventListener('change', function(event) {
      const file = event.target.files[0];
      const errorMessage = document.getElementById('errorMessage');
      const placeholder = document.querySelector('.placeholder-text');
      const imgPreview = document.getElementById('photo');
      
      // Reset states
      errorMessage.style.display = 'none';
      errorMessage.textContent = '';
      
      if (!file) {
          placeholder.style.display = 'block';
          imgPreview.style.display = 'none';
          return;
      }
      
      // Validate file type
      if (!file.type.match('image.*')) {
          errorMessage.textContent = 'الرجاء اختيار ملف صورة فقط (JPG, PNG, etc.)';
          errorMessage.style.display = 'block';
          return;
      }
      
      // Validate file size (e.g., 2MB max)
      if (file.size > 2 * 1024 * 1024) {
          errorMessage.textContent = 'حجم الصورة يجب أن يكون أقل من 2MB';
          errorMessage.style.display = 'block';
          return;
      }
      
      const reader = new FileReader();
      
      reader.onload = function(e) {
          imgPreview.src = e.target.result;
          imgPreview.style.display = 'block';
          placeholder.style.display = 'none';
      };
      
      reader.onerror = function() {
          errorMessage.textContent = 'حدث خطأ أثناء قراءة الملف';
          errorMessage.style.display = 'block';
      };
      
      reader.readAsDataURL(file);
  });
</script>

<script>
    function updateSVG() {
        const name = document.getElementById("nameIm").value;
        const date = document.getElementById("nameDInput").value;
        const name_v = document.getElementById("nameIv").value;
        const photoInput = document.getElementById("photoInput").files[0];
        const photoInput1 = document.getElementById("photoInput1").files[0];

        if (name) {
            document.getElementById("name-m").textContent = name;
        }
        if (date) {
            document.getElementById("text-date").textContent = "بتاريخ :" + date;
        }
        if (name_v) {
            document.getElementById("text-v").textContent = "وذلك بمناسبة " + name_v;
        }
        if (photoInput) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById("photo").setAttribute("href", e.target.result);
            };
            reader.readAsDataURL(photoInput);
        }
        if (photoInput1) {
            const reader1 = new FileReader();
            reader1.onload = function(e) {
                document.getElementById("photo1").setAttribute("href", e.target.result);
            };
            reader1.readAsDataURL(photoInput1);
        }
    }


    function saveAsPNG() {
      const element = document.getElementById("content");
      const name = document.getElementById("nameIm").value;

      if (!element) {
          console.error("Element not found!");
          return;
      }

      const scale = 2;
      const options = {
          scale: scale,
          logging: true,
          useCORS: true,
          allowTaint: true,
          letterRendering: true,
          backgroundColor: "#FFFFFF",
          windowWidth: element.scrollWidth,
          windowHeight: element.scrollHeight
      };

      html2canvas(element, options).then(canvas => {
          // Create HD PNG with maximum quality
          const link = document.createElement('a');
          link.download = name+'.png';
          link.href = canvas.toDataURL("image/png", 1.0); // 1.0 = maximum quality
          link.click();
      }).catch(error => {
          console.error("Error capturing content:", error);
          alert("Error capturing image: " + error.message);
      });
  }

  window.onload = function() {
      document.getElementById("saveButton").addEventListener("click", saveAsPNG);
  };

  function saveAsPDF() {
    const name = document.getElementById("nameIm").value;
    const element = document.getElementById("content");
    if (!element) {
        console.error("Element not found!");
        return;
    }

    // High quality settings
    const scale = 3;
    const dpi = 300; // Target DPI
    const options = {
        scale: scale,
        logging: true,
        useCORS: true,
        letterRendering: true,
        allowTaint: true,
        backgroundColor: "#FFFFFF"
    };

    html2canvas(element, options).then(canvas => {
        const imgData = canvas.toDataURL('image/png', 1.0);
        const pdf = new jspdf.jsPDF({
            orientation: canvas.width > canvas.height ? 'landscape' : 'portrait',
            unit: 'mm',
            format: [canvas.width * 0.264583, canvas.height * 0.264583],
            compress: false,
            hotfixes: ["px_scaling"]
        });

        const width = (canvas.width * 26.7) / dpi * scale;
        const height = (canvas.height * 26.7) / dpi * scale;

        // Add image to PDF
        pdf.addImage({
            imageData: imgData,
            format: 'PNG',
            x: 0,
            y: 0,
            width: width,
            height: height,
            compression: 'NONE'
        });

        pdf.save(name+'.pdf');
    }).catch(error => {
        console.error("Error generating PDF:", error);
        alert("Error generating PDF: " + error.message);
    });
  }


</script>


<script>
  function toggleMenu() {
      document.querySelector('.nav-links').classList.toggle('show');
  }
</script>

</body>
</html>